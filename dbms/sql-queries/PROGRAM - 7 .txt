PROGRAM - 7 

Name 	Type_of_contract	 Amount

Ganesh 	   Account 		-1000
Balu	   Loan                 5000
Ganesh	   Loan   		2000
Balu       Deposit  		500
Ganesh     Deposit 		10000

Write a program or query to bring the following output.

Anwer:

Name 	no_of_deposit 	no_of_Loan 	deposit_amount 	Loan_amount 	account_amount 	    total_amount

Ganesh 		1	 1 		10000 		2000 		-1000 			7000
Balu 		1 	 1 		500 		5000 		  0 		      - 4500


CREATE TABLE TRANSACTIONTABLE (
TRANSACTIONID INT PRIMARY KEY,
NAME VARCHAR(50) NOT NULL,
TYPE_OF_CONTRACT VARCHAR(50) NOT NULL,
AMOUNT INT 
);

INSERT INTO TRANSACTIONTABLE(TRANSACTIONID,NAME,TYPE_OF_CONTRACT,AMOUNT)
(1,'GANESH','ACCOUNT',-1000),
(2,'BALU','LOAN',5000),
(3,'GANESH','LOAN',2000),
(4,'BALU','DEPOSIT',500),
(5,'GANESH','DEPOSIT',10000)

SELECT 
T.NAME ,
COUNT(CASE WHEN T.TYPE_OF_CONTRACT = 'DEPOSIT' THEN 1 ELSE 0 END) AS 'NO_OF_DEPOSIT',
COUNT(CASE WHEN T.TYPE_OF_LOAN = 'LOAN' THEN 1 ELSE 0 END) AS 'NO_OF_LOAN',
SUM(CASE WHEN T.TYPE_OF_CONTRACT = 'DEPOSIT' THEN AMOUNT ELSE 0 END) AS 'DEPOSIT_AMOUNT',
SUM(CASE WHEN T.TYPE_OF_CONTRACT = 'LOAN' THEN AMOUNT ELSE 0 END) AS 'LOAN_AMOUNT',
SUM(CASE WHEN T.TYPE_OF_CONTRACT = 'ACCOUNT' THEN AMOUNT ELSE 0 END) AS 'ACCOUNT_AMOUNT'
SUM(T.AMOUNT) AS TOTAL_AMOUNT
FROM TRANSACTIONTABLE
GROUP BY T.NAME 
WITH ROLLUP;